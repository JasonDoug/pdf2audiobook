(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51635,e=>{"use strict";let s=(0,e.i(78975).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>s],51635)},21603,e=>{"use strict";var s,t=((s={}).PENDING="pending",s.PROCESSING="processing",s.COMPLETED="completed",s.FAILED="failed",s);e.s(["JobStatus",()=>t])},89840,e=>{"use strict";var s=e.i(9743),t=e.i(98646),a=e.i(49016),r=e.i(70627),l=e.i(70499),i=e.i(56285),o=e.i(21603),n=e.i(78975);let d=(0,n.default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),x=(0,n.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),c=(0,n.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),m=(0,n.default)("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);var u=e.i(6181),h=e.i(51635);function p(){let e=(0,a.useParams)(),n=(0,a.useRouter)(),{getToken:p}=(0,r.useAuth)(),[b,f]=(0,t.useState)(null),[j,g]=(0,t.useState)(!0),[N,y]=(0,t.useState)(null),v=e?.id,w="string"==typeof v?Number(v):Array.isArray(v)?Number(v[0]):NaN;return(0,t.useEffect)(()=>{if(!w||Number.isNaN(w)){y("Invalid job ID."),g(!1);return}let e=null,s=!1;return(async()=>{try{let t=await p();if(!t){y("You must be signed in to view this job."),g(!1);return}let a=await (0,i.getJob)(w,t);if(s)return;f(a),y(null),g(!1),(a.status===o.JobStatus.PENDING||a.status===o.JobStatus.PROCESSING)&&(e=setInterval(async()=>{try{let r=await (0,i.getJobStatus)(w,t);if(s)return;f(e=>e?{...e,...r}:{...a,...r});let l=r.status||r.job_status||a.status;(l===o.JobStatus.COMPLETED||l===o.JobStatus.FAILED)&&e&&(clearInterval(e),e=null)}catch(e){console.error("Failed to poll job status",e)}},5e3))}catch(e){console.error("Failed to fetch job",e),y("Failed to load job. Please refresh and try again."),g(!1)}})(),()=>{s=!0,e&&clearInterval(e)}},[w,p]),(0,s.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[(0,s.jsxs)("button",{onClick:()=>n.push("/jobs"),className:"mb-6 inline-flex items-center text-xs sm:text-sm text-slate-500 hover:text-blue-600 transition-colors",children:[(0,s.jsx)(d,{className:"h-4 w-4 mr-1"}),"Back to jobs"]}),(0,s.jsxs)(l.SignedOut,{children:[(0,s.jsxs)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 flex items-start gap-3",children:[(0,s.jsx)(h.AlertCircle,{className:"h-5 w-5 text-amber-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-sm font-semibold text-slate-900",children:"Sign in required"}),(0,s.jsx)("p",{className:"mt-1 text-xs sm:text-sm text-slate-600",children:"You need to be signed in to view job details. Use the header controls to sign in, then return to this page."})]})]}),(0,s.jsx)("div",{className:"mt-6"})]}),(0,s.jsxs)(l.SignedIn,{children:[j&&(0,s.jsxs)("div",{className:"bg-white/80 backdrop-blur border border-slate-100 rounded-2xl px-6 py-10 flex flex-col items-center justify-center shadow-sm",children:[(0,s.jsx)(c,{className:"h-8 w-8 animate-spin text-blue-600 mb-4"}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:"Fetching job details…"})]}),!j&&N&&(0,s.jsxs)("div",{className:"bg-rose-50 border border-rose-200 text-rose-800 px-4 py-3 rounded-xl text-xs sm:text-sm flex items-start gap-2",children:[(0,s.jsx)(h.AlertCircle,{className:"h-4 w-4 mt-0.5"}),(0,s.jsx)("div",{children:N})]}),!j&&!N&&b&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white/80 backdrop-blur border border-slate-100 rounded-2xl p-6 shadow-sm space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(u.FileText,{className:"h-8 w-8 text-blue-500"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-lg sm:text-xl font-semibold text-slate-900 break-words",children:b.original_filename}),(0,s.jsxs)("p",{className:"mt-1 text-xs sm:text-sm text-slate-500",children:["Created"," ",new Date(b.created_at).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-start sm:items-end gap-2",children:[(e=>{let t="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium";switch(e){case o.JobStatus.COMPLETED:return(0,s.jsx)("span",{className:`${t} bg-emerald-50 text-emerald-700`,children:"Completed"});case o.JobStatus.FAILED:return(0,s.jsx)("span",{className:`${t} bg-rose-50 text-rose-700`,children:"Failed"});case o.JobStatus.PROCESSING:return(0,s.jsx)("span",{className:`${t} bg-blue-50 text-blue-700`,children:"In progress"});case o.JobStatus.PENDING:default:return(0,s.jsx)("span",{className:`${t} bg-amber-50 text-amber-700`,children:"Queued"})}})(b.status),(0,s.jsxs)("p",{className:"text-[10px] sm:text-xs text-slate-500",children:["Voice: ",b.voice_provider," · ",b.voice_type," ·  Speed: ",b.reading_speed,"x"]}),(0,s.jsxs)("p",{className:"text-[10px] sm:text-xs text-slate-500",children:["Mode:"," ","summary_explanation"===b.conversion_mode?"AI summary & explanation":"Full text narration"]})]})]}),(b.status===o.JobStatus.PENDING||b.status===o.JobStatus.PROCESSING)&&(0,s.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,s.jsx)("div",{className:"w-full bg-slate-100 rounded-full h-2 overflow-hidden",children:(0,s.jsx)("div",{className:"h-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 transition-all duration-500",style:{width:`${Math.min(Math.max(b.progress_percentage||10,10),95)}%`}})}),(0,s.jsx)("p",{className:"text-[10px] sm:text-xs text-slate-500",children:"Your PDF is being processed using our OCR and TTS pipeline. For long or scanned papers, this can take a few minutes."})]}),b.status===o.JobStatus.FAILED&&b.error_message&&(0,s.jsxs)("div",{className:"mt-2 bg-rose-50 border border-rose-200 rounded-xl px-3 py-2 text-[10px] sm:text-xs text-rose-800 flex gap-2",children:[(0,s.jsx)(h.AlertCircle,{className:"h-4 w-4 mt-0.5 shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium mb-0.5",children:"Conversion failed"}),(0,s.jsx)("div",{children:b.error_message})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/80 backdrop-blur border border-slate-100 rounded-2xl p-6 shadow-sm space-y-4",children:[(0,s.jsx)("h2",{className:"text-sm sm:text-base font-semibold text-slate-900",children:"Output"}),b.status===o.JobStatus.COMPLETED&&b.audio_s3_url&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m,{className:"h-6 w-6 text-blue-500"}),(0,s.jsx)("div",{className:"text-xs sm:text-sm text-slate-700",children:"Stream the generated audio directly, or download it for offline listening."})]}),(0,s.jsxs)("button",{onClick:()=>{b?.audio_s3_url&&window.open(b.audio_s3_url,"_blank","noopener,noreferrer")},className:"inline-flex items-center justify-center px-3 py-1.5 rounded-lg bg-blue-600 text-white text-[10px] sm:text-xs font-medium hover:bg-blue-700 transition-colors",children:[(0,s.jsx)(x,{className:"h-3 w-3 mr-1.5"}),"Download audio"]})]}),(0,s.jsx)("audio",{controls:!0,src:b.audio_s3_url,className:"w-full rounded-lg border border-slate-200",children:"Your browser does not support the audio element."})]}),b.status===o.JobStatus.COMPLETED&&!b.audio_s3_url&&(0,s.jsxs)("div",{className:"flex items-start gap-2 text-[10px] sm:text-xs text-slate-600",children:[(0,s.jsx)(h.AlertCircle,{className:"h-4 w-4 mt-0.5 text-amber-500"}),(0,s.jsx)("div",{children:"This job is marked as completed, but no audio URL is available. If this is unexpected, verify the backend configuration or S3 permissions."})]}),(b.status===o.JobStatus.PENDING||b.status===o.JobStatus.PROCESSING)&&(0,s.jsxs)("div",{className:"flex items-start gap-2 text-[10px] sm:text-xs text-slate-600",children:[(0,s.jsx)(c,{className:"h-4 w-4 mt-0.5 animate-spin text-blue-500"}),(0,s.jsx)("div",{children:"We are extracting text, generating the narration or summary, and preparing your audio. You can safely leave this page and return later from the “My Jobs” view."})]}),b.status===o.JobStatus.FAILED&&(0,s.jsxs)("div",{className:"flex items-start gap-2 text-[10px] sm:text-xs text-slate-600",children:[(0,s.jsx)(h.AlertCircle,{className:"h-4 w-4 mt-0.5 text-rose-500"}),(0,s.jsxs)("div",{children:["If this is a scanned or very large PDF, try again with a clearer copy or contact support with this job ID:"," ",(0,s.jsx)("span",{className:"font-mono text-rose-700",children:b.id}),"."]})]})]}),(0,s.jsx)("div",{className:"text-[9px] sm:text-[10px] text-slate-500 leading-relaxed",children:(0,s.jsx)("p",{children:"Tip for researchers: use the summary mode for dense scientific PDFs to get an AI-generated overview you can listen to while commuting. For deep reading of novels or long-form reports, use full-text narration for a faithful audiobook experience."})})]})]})]})}e.s(["default",()=>p],89840)}]);