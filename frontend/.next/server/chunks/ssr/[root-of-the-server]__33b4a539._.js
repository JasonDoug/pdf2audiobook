module.exports=[24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},11918,a=>{"use strict";let b=(0,a.i(94649).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],11918)},78283,a=>{"use strict";var b,c=((b={}).PENDING="pending",b.PROCESSING="processing",b.COMPLETED="completed",b.FAILED="failed",b);a.s(["JobStatus",()=>c])},45363,a=>{"use strict";var b=a.i(33949),c=a.i(26343),d=a.i(6106),e=a.i(22712),f=a.i(83987),g=a.i(23795),h=a.i(78283),i=a.i(94649);let j=(0,i.default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),k=(0,i.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),l=(0,i.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),m=(0,i.default)("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);var n=a.i(14262),o=a.i(11918);function p(){let a=(0,d.useParams)(),i=(0,d.useRouter)(),{getToken:p}=(0,e.useAuth)(),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(null),w=a?.id,x="string"==typeof w?Number(w):Array.isArray(w)?Number(w[0]):NaN;return(0,c.useEffect)(()=>{if(!x||Number.isNaN(x)){v("Invalid job ID."),t(!1);return}let a=null,b=!1;return(async()=>{try{let c=await p();if(!c){v("You must be signed in to view this job."),t(!1);return}let d=await (0,g.getJob)(x,c);if(b)return;r(d),v(null),t(!1),(d.status===h.JobStatus.PENDING||d.status===h.JobStatus.PROCESSING)&&(a=setInterval(async()=>{try{let e=await (0,g.getJobStatus)(x,c);if(b)return;r(a=>a?{...a,...e}:{...d,...e});let f=e.status||e.job_status||d.status;(f===h.JobStatus.COMPLETED||f===h.JobStatus.FAILED)&&a&&(clearInterval(a),a=null)}catch(a){console.error("Failed to poll job status",a)}},5e3))}catch(a){console.error("Failed to fetch job",a),v("Failed to load job. Please refresh and try again."),t(!1)}})(),()=>{b=!0,a&&clearInterval(a)}},[x,p]),(0,b.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[(0,b.jsxs)("button",{onClick:()=>i.push("/jobs"),className:"mb-6 inline-flex items-center text-xs sm:text-sm text-slate-500 hover:text-blue-600 transition-colors",children:[(0,b.jsx)(j,{className:"h-4 w-4 mr-1"}),"Back to jobs"]}),(0,b.jsxs)(f.SignedOut,{children:[(0,b.jsxs)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 flex items-start gap-3",children:[(0,b.jsx)(o.AlertCircle,{className:"h-5 w-5 text-amber-500 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-sm font-semibold text-slate-900",children:"Sign in required"}),(0,b.jsx)("p",{className:"mt-1 text-xs sm:text-sm text-slate-600",children:"You need to be signed in to view job details. Use the header controls to sign in, then return to this page."})]})]}),(0,b.jsx)("div",{className:"mt-6"})]}),(0,b.jsxs)(f.SignedIn,{children:[s&&(0,b.jsxs)("div",{className:"bg-white/80 backdrop-blur border border-slate-100 rounded-2xl px-6 py-10 flex flex-col items-center justify-center shadow-sm",children:[(0,b.jsx)(l,{className:"h-8 w-8 animate-spin text-blue-600 mb-4"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:"Fetching job details…"})]}),!s&&u&&(0,b.jsxs)("div",{className:"bg-rose-50 border border-rose-200 text-rose-800 px-4 py-3 rounded-xl text-xs sm:text-sm flex items-start gap-2",children:[(0,b.jsx)(o.AlertCircle,{className:"h-4 w-4 mt-0.5"}),(0,b.jsx)("div",{children:u})]}),!s&&!u&&q&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white/80 backdrop-blur border border-slate-100 rounded-2xl p-6 shadow-sm space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"mt-1",children:(0,b.jsx)(n.FileText,{className:"h-8 w-8 text-blue-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg sm:text-xl font-semibold text-slate-900 break-words",children:q.original_filename}),(0,b.jsxs)("p",{className:"mt-1 text-xs sm:text-sm text-slate-500",children:["Created"," ",new Date(q.created_at).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col items-start sm:items-end gap-2",children:[(a=>{let c="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium";switch(a){case h.JobStatus.COMPLETED:return(0,b.jsx)("span",{className:`${c} bg-emerald-50 text-emerald-700`,children:"Completed"});case h.JobStatus.FAILED:return(0,b.jsx)("span",{className:`${c} bg-rose-50 text-rose-700`,children:"Failed"});case h.JobStatus.PROCESSING:return(0,b.jsx)("span",{className:`${c} bg-blue-50 text-blue-700`,children:"In progress"});case h.JobStatus.PENDING:default:return(0,b.jsx)("span",{className:`${c} bg-amber-50 text-amber-700`,children:"Queued"})}})(q.status),(0,b.jsxs)("p",{className:"text-[10px] sm:text-xs text-slate-500",children:["Voice: ",q.voice_provider," · ",q.voice_type," ·  Speed: ",q.reading_speed,"x"]}),(0,b.jsxs)("p",{className:"text-[10px] sm:text-xs text-slate-500",children:["Mode:"," ","summary_explanation"===q.conversion_mode?"AI summary & explanation":"Full text narration"]})]})]}),(q.status===h.JobStatus.PENDING||q.status===h.JobStatus.PROCESSING)&&(0,b.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,b.jsx)("div",{className:"w-full bg-slate-100 rounded-full h-2 overflow-hidden",children:(0,b.jsx)("div",{className:"h-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 transition-all duration-500",style:{width:`${Math.min(Math.max(q.progress_percentage||10,10),95)}%`}})}),(0,b.jsx)("p",{className:"text-[10px] sm:text-xs text-slate-500",children:"Your PDF is being processed using our OCR and TTS pipeline. For long or scanned papers, this can take a few minutes."})]}),q.status===h.JobStatus.FAILED&&q.error_message&&(0,b.jsxs)("div",{className:"mt-2 bg-rose-50 border border-rose-200 rounded-xl px-3 py-2 text-[10px] sm:text-xs text-rose-800 flex gap-2",children:[(0,b.jsx)(o.AlertCircle,{className:"h-4 w-4 mt-0.5 shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium mb-0.5",children:"Conversion failed"}),(0,b.jsx)("div",{children:q.error_message})]})]})]}),(0,b.jsxs)("div",{className:"bg-white/80 backdrop-blur border border-slate-100 rounded-2xl p-6 shadow-sm space-y-4",children:[(0,b.jsx)("h2",{className:"text-sm sm:text-base font-semibold text-slate-900",children:"Output"}),q.status===h.JobStatus.COMPLETED&&q.audio_s3_url&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m,{className:"h-6 w-6 text-blue-500"}),(0,b.jsx)("div",{className:"text-xs sm:text-sm text-slate-700",children:"Stream the generated audio directly, or download it for offline listening."})]}),(0,b.jsxs)("button",{onClick:()=>{q?.audio_s3_url&&window.open(q.audio_s3_url,"_blank","noopener,noreferrer")},className:"inline-flex items-center justify-center px-3 py-1.5 rounded-lg bg-blue-600 text-white text-[10px] sm:text-xs font-medium hover:bg-blue-700 transition-colors",children:[(0,b.jsx)(k,{className:"h-3 w-3 mr-1.5"}),"Download audio"]})]}),(0,b.jsx)("audio",{controls:!0,src:q.audio_s3_url,className:"w-full rounded-lg border border-slate-200",children:"Your browser does not support the audio element."})]}),q.status===h.JobStatus.COMPLETED&&!q.audio_s3_url&&(0,b.jsxs)("div",{className:"flex items-start gap-2 text-[10px] sm:text-xs text-slate-600",children:[(0,b.jsx)(o.AlertCircle,{className:"h-4 w-4 mt-0.5 text-amber-500"}),(0,b.jsx)("div",{children:"This job is marked as completed, but no audio URL is available. If this is unexpected, verify the backend configuration or S3 permissions."})]}),(q.status===h.JobStatus.PENDING||q.status===h.JobStatus.PROCESSING)&&(0,b.jsxs)("div",{className:"flex items-start gap-2 text-[10px] sm:text-xs text-slate-600",children:[(0,b.jsx)(l,{className:"h-4 w-4 mt-0.5 animate-spin text-blue-500"}),(0,b.jsx)("div",{children:"We are extracting text, generating the narration or summary, and preparing your audio. You can safely leave this page and return later from the “My Jobs” view."})]}),q.status===h.JobStatus.FAILED&&(0,b.jsxs)("div",{className:"flex items-start gap-2 text-[10px] sm:text-xs text-slate-600",children:[(0,b.jsx)(o.AlertCircle,{className:"h-4 w-4 mt-0.5 text-rose-500"}),(0,b.jsxs)("div",{children:["If this is a scanned or very large PDF, try again with a clearer copy or contact support with this job ID:"," ",(0,b.jsx)("span",{className:"font-mono text-rose-700",children:q.id}),"."]})]})]}),(0,b.jsx)("div",{className:"text-[9px] sm:text-[10px] text-slate-500 leading-relaxed",children:(0,b.jsx)("p",{children:"Tip for researchers: use the summary mode for dense scientific PDFs to get an AI-generated overview you can listen to while commuting. For deep reading of novels or long-form reports, use full-text narration for a faithful audiobook experience."})})]})]})]})}a.s(["default",()=>p],45363)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__33b4a539._.js.map